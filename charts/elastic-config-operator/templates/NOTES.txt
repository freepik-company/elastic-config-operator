üéâ Elastic Config Operator has been installed!

üìã Release Information:
  - Release Name: {{ .Release.Name }}
  - Namespace: {{ .Release.Namespace }}
  - Chart Version: {{ .Chart.Version }}
  - App Version: {{ .Chart.AppVersion }}

{{- if .Values.crds.install }}
‚úÖ CRDs Installation:
  The following Custom Resource Definitions have been installed:
  - IndexLifecyclePolicy
  - IndexTemplate
  - SnapshotLifecyclePolicy
  - SnapshotRepository

{{- if .Values.crds.keep }}
  ‚ö†Ô∏è  Note: CRDs are configured to be KEPT on uninstall to prevent data loss.
  To remove CRDs manually, run:
    kubectl delete crd indexlifecyclepolicies.elastic-config-operator.freepik.com
    kubectl delete crd indextemplates.elastic-config-operator.freepik.com
    kubectl delete crd snapshotlifecyclepolicies.elastic-config-operator.freepik.com
    kubectl delete crd snapshotrepositories.elastic-config-operator.freepik.com
{{- end }}
{{- else }}
‚ö†Ô∏è  CRDs were NOT installed. You must install them manually:
  kubectl apply -f https://raw.githubusercontent.com/freepik-company/elastic-config-operator/main/config/crd/bases/
{{- end }}

üîê RBAC Configuration:
{{- if .Values.controller.rbac.clusterWideSecrets }}
  - Secret Access: Cluster-wide (all namespaces)
{{- else }}
  {{- if .Values.controller.rbac.secretsNamespaces }}
  - Secret Access: Limited to specific namespaces
    {{- range .Values.controller.rbac.secretsNamespaces }}
    - {{ . }}
    {{- end }}
  {{- else }}
  - ‚ö†Ô∏è  Warning: No namespaces configured for secret access!
  {{- end }}
{{- end }}

üìä Metrics:
{{- if .Values.controller.metrics.enabled }}
  - Metrics endpoint: {{ .Release.Name }}-metrics:{{ .Values.controller.metrics.service.port }}
  {{- if .Values.controller.metrics.service.enabled }}
  - Access metrics: kubectl port-forward -n {{ .Release.Namespace }} svc/{{ include "elastic-config-operator.fullname" . }}-metrics {{ .Values.controller.metrics.service.port }}:{{ .Values.controller.metrics.service.port }}
  {{- end }}
{{- else }}
  - Metrics are disabled
{{- end }}

üöÄ Quick Start:

1. Verify the operator is running:
   kubectl get deployment -n {{ .Release.Namespace }} {{ include "elastic-config-operator.fullname" . }}

2. Check operator logs:
   kubectl logs -n {{ .Release.Namespace }} -l app.kubernetes.io/name={{ include "elastic-config-operator.name" . }} -f

3. Create your first IndexLifecyclePolicy:
   kubectl apply -f - <<EOF
   apiVersion: elastic-config-operator.freepik.com/v1alpha1
   kind: IndexLifecyclePolicy
   metadata:
     name: my-ilm-policy
   spec:
     syncInterval: "30s"
     resourceSelector:
       name: elasticsearch
       namespace: default
     resources:
       30d-retention:
         policy:
           phases:
             hot:
               min_age: "0ms"
               actions:
                 rollover:
                   max_age: "7d"
             delete:
               min_age: "30d"
               actions:
                 delete: {}
   EOF

4. Check the status:
   kubectl get indexlifecyclepolicies
   kubectl describe indexlifecyclepolicy my-ilm-policy

üìñ Documentation:
  - GitHub: https://github.com/freepik-company/elastic-config-operator
  - Helm Chart: https://github.com/freepik-company/elastic-config-operator/tree/main/charts/elastic-config-operator

üí° Tips:
  - Use 'kubectl get indexlifecyclepolicies -o wide' to see detailed status
  - Monitor operator logs for troubleshooting
  - CRDs are kept on uninstall by default (helm.sh/resource-policy: keep)

{{- if not .Values.controller.rbac.clusterWideSecrets }}
{{- if eq (len .Values.controller.rbac.secretsNamespaces) 0 }}

‚ö†Ô∏è  WARNING: No secret access configured!
  The operator won't be able to read Elasticsearch credentials.
  Configure either:
  - controller.rbac.clusterWideSecrets=true, or
  - controller.rbac.secretsNamespaces=[...]
{{- end }}
{{- end }}

