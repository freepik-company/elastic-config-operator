apiVersion: eck-config-operator.freepik.com/v1alpha1
kind: SnapshotLifecyclePolicy
metadata:
  labels:
    app.kubernetes.io/name: eck-config-operator
    app.kubernetes.io/managed-by: kustomize
  name: snapshotlifecyclepolicy-sample
spec:
  # SyncInterval defines how often the operator will reconcile this resource (default: 10s)
  # Examples: "30s", "5m", "1h"
  # syncInterval: "30s"

  # For ECK cluster, you can use just the name of the cluster (namespace too if is different from the resource) and the
  # operator will automatically get the endpoint, username, password and ca certificate from the ECK cluster.
  resourceSelector:
    name: elasticsearch
    # namespace: default
    endpoint: https://localhost:9200
    username: elastic
    passwordSecretRef:
      name: elasticsearch-es-elastic-user
      namespace: default
      key: elastic
    # If not defined, the operator will skip TLS verification if the endpoint is configured manually
    # caCertSecretRef:
    #   name: elasticsearch-es-http-certs-public
    #   namespace: default
    #   key: tls.crt
  resources:
    daily-snapshots:
      # Elasticsearch uses 6-field cron format: Seconds Minutes Hours Day Month DayOfWeek
      # This example runs at 1:00 AM every day
      schedule: "0 0 1 * * ?"
      name: "<daily-snap-{now/d}>"
      repository: my-fs-repository
      config:
        indices: ["*"]
        ignore_unavailable: false
        include_global_state: false
      retention:
        expire_after: "30d"
        min_count: 5
        max_count: 50
