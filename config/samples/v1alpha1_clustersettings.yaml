apiVersion: elastic-config-operator.freepik.com/v1alpha1
kind: ClusterSettings
metadata:
  labels:
    app.kubernetes.io/name: elastic-config-operator
    app.kubernetes.io/managed-by: kustomize
  name: clustersettings-sample
spec:
  # SyncInterval defines how often the operator will reconcile this resource (default: 10s)
  # Examples: "30s", "5m", "1h"
  syncInterval: "30s"
  
  # For ECK cluster, you can use just the name of the cluster (namespace too if is different from the resource) and the
  # operator will automatically get the endpoint, username, password and ca certificate from the ECK cluster.
  resourceSelector:
    name: elasticsearch
    # namespace: default
    endpoint: https://localhost:9200
    username: elastic
    passwordSecretRef:
      name: elasticsearch-es-elastic-user
      namespace: default
      key: elastic
    # If not defined, the operator will skip TLS verification if the endpoint is configured manually
    # caCertSecretRef:
    #   name: elasticsearch-es-http-certs-public
    #   namespace: default
    #   key: tls.crt
  
  # Resources contains the cluster settings to apply
  # Each key represents a category: "persistent" or "transient"
  # Persistent settings survive cluster restarts, transient settings don't
  resources:
    # Persistent cluster settings (survive cluster restarts)
    persistent:
      # Configure the number of concurrent shard rebalancing operations
      cluster.routing.allocation.cluster_concurrent_rebalance: 2
      # Enable/disable shard allocation
      cluster.routing.allocation.enable: "all"
      # Configure the number of shards being recovered simultaneously
      cluster.routing.allocation.node_concurrent_recoveries: 2
      # Set the cluster read-only mode (false to allow writes)
      cluster.blocks.read_only: false
      # Configure index lifecycle management poll interval
      indices.lifecycle.poll_interval: "15m"
    
    # Transient cluster settings (don't survive cluster restarts)
    # Useful for temporary configurations during maintenance
    # transient:
    #   # Temporarily disable shard allocation (useful during cluster maintenance)
    #   cluster.routing.allocation.enable: "none"
    #   # Set a custom logger level for debugging
    #   logger.org.elasticsearch.cluster: "DEBUG"
